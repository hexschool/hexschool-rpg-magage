(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1f339db2"],{"0673":function(e,t,a){},1728:function(e,t,a){"use strict";a.r(t);a("b0c0");var c=a("7a23"),s={class:"about px-4 mt-4"},n=Object(c["i"])("p",null,[Object(c["i"])("span",{class:"material-icons align-bottom"},"arrow_back"),Object(c["h"])("返回")],-1),i={class:"row position-relative align-items-start"},l={class:"col-md-4 users-sticky-md-top",style:{top:"80px"}},o={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},r={class:"card-header bg-white py-3"},d={key:1,style:{width:"60px",height:"60px"},class:"rounded-circle mx-auto bg-light mb-1"},b={class:"text-center mb-0"},u={class:"card-body display-12 fw-normal"},O={class:"list-unstyled list-unstyled-py-3 mb-0"},m={key:0,class:"mb-1"},j=Object(c["i"])("span",{class:"material-icons align-middle fs-6"}," person ",-1),p={key:1,class:"mb-1"},f=Object(c["i"])("span",{class:"material-icons align-middle fs-6"}," mail ",-1),v={key:2,class:"mb-1 border-top pt-3"},g=Object(c["i"])("span",{class:"material-icons align-middle fs-6"}," settings_ethernet ",-1),h=Object(c["h"])(" 已綁定 Github 帳號 "),y=Object(c["i"])("div",{class:"nav flex-column nav-pills shadow-sm rounded-4 border overflow-hidden",id:"v-pills-tab",role:"tablist","aria-orientation":"vertical"},[Object(c["i"])("button",{class:"nav-link active border-bottom rounded-0",id:"v-pills-home-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-home",type:"button",role:"tab","aria-controls":"v-pills-home","aria-selected":"true"},"個人資料"),Object(c["i"])("button",{class:"nav-link border-bottom rounded-0",id:"v-pills-profile-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-profile",type:"button",role:"tab","aria-controls":"v-pills-profile","aria-selected":"false"},"權限管理"),Object(c["i"])("button",{class:"nav-link border-bottom rounded-0",id:"v-pills-messages-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-messages",type:"button",role:"tab","aria-controls":"v-pills-messages","aria-selected":"false"},"訂單資訊"),Object(c["i"])("button",{class:"nav-link border-bottom rounded-0",id:"v-pills-settings-tab","data-bs-toggle":"pill","data-bs-target":"#v-pills-settings",type:"button",role:"tab","aria-controls":"v-pills-settings","aria-selected":"false"},"危險操作")],-1),k={class:"col-md-8"},x={class:"tab-content",id:"v-pills-tabContent"},w={class:"tab-pane fade show active",id:"v-pills-home",role:"tabpanel","aria-labelledby":"v-pills-home-tab"},L={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},I=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," settings_accessibility "),Object(c["h"])(" 個人資訊 ")])],-1),_={class:"card-body"},D={class:"mb-3"},U=Object(c["i"])("label",{for:"nickname",class:"form-label"},"暱稱",-1),M={class:"mb-3"},A=Object(c["i"])("label",{for:"name",class:"form-label"},"使用者姓名",-1),R={class:"mb-3"},E=Object(c["i"])("label",{for:"password",class:"form-label"},"重設密碼",-1),N=Object(c["i"])("small",{class:"text-muted"},"最短 8 字元，且必須含有英文大小寫與數字混合",-1),C=Object(c["i"])("hr",null,null,-1),H={class:"tab-pane fade",id:"v-pills-profile",role:"tabpanel","aria-labelledby":"v-pills-profile-tab"},T={class:"tab-pane fade",id:"v-pills-messages",role:"tabpanel","aria-labelledby":"v-pills-messages-tab"},B={class:"tab-pane fade",id:"v-pills-settings",role:"tabpanel","aria-labelledby":"v-pills-settings-tab"},P={class:"card border-danger shadow-sm rounded-4 overflow-hidden mb-4"},J=Object(c["i"])("div",{class:"card-header bg-white py-3 border-danger"},[Object(c["i"])("p",{class:"mb-0 text-danger"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," warning "),Object(c["h"])(" 危險操作 ")])],-1),V={class:"card-body"},z={class:"d-flex"},S=Object(c["i"])("div",{class:"flex-fill text-muted"},[Object(c["i"])("h5",null,"暫停用戶"),Object(c["i"])("p",{class:"mb-0"},"一定要這樣做嗎？他會不能再次登入哦！")],-1),G=Object(c["i"])("hr",null,null,-1),$={class:"d-flex"},F=Object(c["i"])("div",{class:"flex-fill text-muted"},[Object(c["i"])("h5",null,"刪除用戶"),Object(c["i"])("p",{class:"mb-0"},"他只是輸入錯 Email 吧？")],-1);function q(e,t,a,q,K,Q){var W=Object(c["B"])("loading"),X=Object(c["B"])("router-link"),Y=Object(c["B"])("UserLog"),Z=Object(c["B"])("RoleAndPermissions"),ee=Object(c["B"])("OrderList"),te=Object(c["B"])("AlertModal"),ae=Object(c["B"])("DangerActionsModal");return Object(c["u"])(),Object(c["e"])("div",s,[Object(c["i"])(W,{active:q.isLoading,"is-full-page":q.fullPage,"z-index":1021},null,8,["active","is-full-page"]),Object(c["i"])(X,{to:"/admin/users"},{default:Object(c["N"])((function(){return[n]})),_:1}),Object(c["i"])("div",i,[Object(c["i"])("div",l,[Object(c["i"])("div",o,[Object(c["i"])("div",r,[e.userInfo.avatar?(Object(c["u"])(),Object(c["e"])("img",{key:0,src:e.userInfo.avatar,alt:"頭像"},null,8,["src"])):(Object(c["u"])(),Object(c["e"])("div",d)),Object(c["i"])("p",b,Object(c["E"])(e.userInfo.nickname),1)]),Object(c["i"])("div",u,[Object(c["i"])("ul",O,[e.userInfo.name?(Object(c["u"])(),Object(c["e"])("li",m,[j,Object(c["h"])(" "+Object(c["E"])(e.userInfo.name),1)])):Object(c["f"])("",!0),e.userInfo.secondary_email?(Object(c["u"])(),Object(c["e"])("li",p,[f,Object(c["h"])(" "+Object(c["E"])(e.userInfo.secondary_email),1)])):Object(c["f"])("",!0),e.userInfo.thirdparty&&e.userInfo.thirdparty.length>0?(Object(c["u"])(),Object(c["e"])("li",v,[g,h])):Object(c["f"])("",!0)])])]),y]),Object(c["i"])("div",k,[Object(c["i"])("div",x,[Object(c["i"])("div",w,[Object(c["i"])("div",L,[I,Object(c["i"])("div",_,[Object(c["i"])("div",D,[U,Object(c["O"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"nickname","onUpdate:modelValue":t[1]||(t[1]=function(t){return e.tempData.nickname=t})},null,512),[[c["J"],e.tempData.nickname]])]),Object(c["i"])("div",M,[A,Object(c["O"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":t[2]||(t[2]=function(t){return e.tempData.name=t})},null,512),[[c["J"],e.tempData.name]])]),Object(c["i"])("div",R,[E,Object(c["O"])(Object(c["i"])("input",{type:"password",class:"form-control",id:"password","onUpdate:modelValue":t[3]||(t[3]=function(t){return e.tempData.password=t})},null,512),[[c["J"],e.tempData.password]]),N]),Object(c["i"])("button",{class:"btn btn-secondary",onClick:t[4]||(t[4]=function(t){return q.updateUerInfo(e.userInfo.user_id)})},"儲存"),C,Object(c["i"])("button",{class:"btn btn-sm btn-outline-secondary",onClick:t[5]||(t[5]=function(t){return q.OpenAlertModal("resetPassword",e.userInfo.nickname,e.userInfo.user_id)})},"發重設密碼信")])]),Object(c["i"])(Y,{id:e.userInfo.user_id},null,8,["id"])]),Object(c["i"])("div",H,[Object(c["i"])(Z)]),Object(c["i"])("div",T,[Object(c["i"])(ee)]),Object(c["i"])("div",B,[Object(c["i"])("div",P,[J,Object(c["i"])("div",V,[Object(c["i"])("div",z,[S,Object(c["i"])("button",{class:"btn btn-danger px-4",onClick:t[6]||(t[6]=function(t){return q.OpenDangerModal("deactivated",e.userInfo.nickname)})},"停權")]),G,Object(c["i"])("div",$,[F,Object(c["i"])("button",{class:"btn btn-outline-danger px-4",onClick:t[7]||(t[7]=function(t){return q.OpenDangerModal("deleteAccount",e.userInfo.nickname)})},"刪除用戶")])])])])])])]),Object(c["i"])(te,{type:q.alertModalType,name:q.alertModalUserName,onComfirm:q.comfirmAlertModal},null,8,["type","name","onComfirm"]),Object(c["i"])(ae,{type:q.dangerActionsType,name:q.dangerActionsName,onDangerUserMethod:q.dangerUserMethod},null,8,["type","name","onDangerUserMethod"])])}var K=a("5530"),Q=a("6c02"),W=a("7b17"),X=a("1f79"),Y=Object(c["h"])("確定刪除 "),Z=Object(c["h"])(" 這個用戶嗎？"),ee={class:"my-2"},te=Object(c["h"])("確認要停用 "),ae=Object(c["h"])(" 這個用戶嗎？"),ce={class:"my-2"};function se(e,t,a,s,n,i){var l=this,o=Object(c["B"])("Modal");return Object(c["u"])(),Object(c["e"])(o,{id:"userDangerActions",hasFooter:!0,title:"deactivated"==s.ModalType?"停用帳戶":"刪除帳戶",classList:"bg-danger text-white"},{body:Object(c["N"])((function(){return["deleteAccount"==s.ModalType?(Object(c["u"])(),Object(c["e"])(c["a"],{key:0},[Object(c["i"])("p",null,[Y,Object(c["i"])("b",null,Object(c["E"])(s.UserName),1),Z]),Object(c["i"])("div",ee,[Object(c["O"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"deactivated","onUpdate:modelValue":t[1]||(t[1]=function(e){return s.deleteName=e}),placeholder:"請輸入使用者暱稱（上面粗體文字）"},null,512),[[c["J"],s.deleteName]])])],64)):Object(c["f"])("",!0),"deactivated"==s.ModalType?(Object(c["u"])(),Object(c["e"])(c["a"],{key:1},[Object(c["i"])("p",null,[te,Object(c["i"])("b",null,Object(c["E"])(s.UserName),1),ae]),Object(c["i"])("div",ce,[Object(c["O"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"deactivated","onUpdate:modelValue":t[2]||(t[2]=function(e){return s.deactivatedName=e}),placeholder:"請輸入使用者暱稱（上面粗體文字）"},null,512),[[c["J"],s.deactivatedName]])])],64)):Object(c["f"])("",!0)]})),footer:Object(c["N"])((function(){return["deactivated"==s.ModalType?(Object(c["u"])(),Object(c["e"])("button",{key:0,disabled:s.deactivatedName!==s.UserName,type:"button",class:"btn btn-danger",onClick:t[3]||(t[3]=function(e){return l.$emit("danger-user-method",{type:"deactivated"})})},"停用帳戶",8,["disabled"])):Object(c["f"])("",!0),"deleteAccount"==s.ModalType?(Object(c["u"])(),Object(c["e"])("button",{key:1,type:"button",disabled:s.deleteName!==s.UserName,class:"btn btn-danger",onClick:t[4]||(t[4]=function(e){return l.$emit("danger-user-method",{type:"delete"})})},"刪除帳戶",8,["disabled"])):Object(c["f"])("",!0)]})),_:1},8,["title"])}var ne=a("714b"),ie={name:"AlertModal",components:{Modal:ne["a"]},props:{name:String,type:String},setup:function(e){var t=Object(c["x"])(""),a=Object(c["x"])(""),s=Object(c["c"])((function(){return e.type})),n=Object(c["c"])((function(){return e.name}));return Object(c["s"])((function(){document.getElementById("userDangerActions").addEventListener("hidden.bs.modal",(function(){t.value="",a.value=""}))})),{deactivatedName:t,deleteName:a,ModalType:s,UserName:n}}};ie.render=se;var le=ie,oe={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},re=Object(c["g"])('<div class="card-header bg-white py-3"><p class="mb-0"><span class="material-icons align-bottom"> savings </span> 付款紀錄 </p></div><div class="card-body p-0"><div class="bg-light p-3"><table class="table"><tbody><tr><th scope="row">用戶名稱</th><td>卡斯伯</td></tr><tr><th scope="row">Email</th><td>casper@hexschool.com</td></tr><tr><th scope="row">付款總金額</th><td>$12,300</td></tr><tr><th scope="row">ID</th><td>-Mks3o3985mjn3</td></tr></tbody></table></div><div class="p-3 table-responsive"><table class="table"><thead><tr><th scope="col">建立時間</th><th scope="col">付款時間</th><th scope="col">總金額</th><th scope="col">主要品項</th><th scope="col">查看細節</th></tr></thead><tbody><tr><th scope="row">2020-12-15</th><td>尚未付款</td><td>5880</td><td>六角學院商品</td><td><button class="btn btn-sm btn-outline-primary">訂單細節</button></td></tr></tbody></table></div></div>',2);function de(e,t,a,s,n,i){return Object(c["u"])(),Object(c["e"])("div",oe,[re])}var be={name:"OrderList"};be.render=de;var ue=be,Oe={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},me=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," sentiment_very_satisfied "),Object(c["h"])(" 管理者訊息")])],-1),je={class:"card-body"},pe={class:"d-flex align-items-end"},fe={class:"flex-fill me-2"},ve=Object(c["i"])("label",{for:"admin_remark",class:"form-label"},"抱怨訊息",-1),ge=Object(c["i"])("hr",null,null,-1),he=Object(c["i"])("p",{class:"mb-1"},"註記紀錄",-1),ye={class:"bg-light p-3 display-12 fw-normal mb-3\n        overflow-y-auto position-relative",style:{"max-height":"200px",height:"150px"}},ke={key:0,class:"overlay position-absolute d-flex align-items-center justify-content-center",style:{top:"0",bottom:"0",left:"0",right:"0"}},xe=Object(c["h"])("載入訊息 "),we={key:0,class:"spinner-border spinner-border-sm",role:"status"},Le=Object(c["i"])("span",{class:"visually-hidden"},"Loading...",-1),Ie={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},_e=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," announcement "),Object(c["h"])(" 管理者操作")])],-1),De={class:"card-body"},Ue={class:"bg-light p-3 display-12 fw-normal mb-3\n        overflow-y-auto position-relative",style:{"max-height":"200px",height:"150px"}},Me={key:0,class:"overlay position-absolute d-flex align-items-center justify-content-center",style:{top:"0",bottom:"0",left:"0",right:"0"}},Ae=Object(c["h"])("載入訊息 "),Re={key:0,class:"spinner-border spinner-border-sm",role:"status"},Ee=Object(c["i"])("span",{class:"visually-hidden"},"Loading...",-1),Ne={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},Ce=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," announcement "),Object(c["h"])(" 系統操作紀錄")])],-1),He={class:"card-body"},Te={class:"bg-light p-3 display-12 fw-normal mb-3\n        overflow-y-auto position-relative",style:{"max-height":"200px",height:"150px"}},Be={key:0,class:"overlay position-absolute d-flex align-items-center justify-content-center",style:{top:"0",bottom:"0",left:"0",right:"0"}},Pe=Object(c["h"])("載入訊息 "),Je={key:0,class:"spinner-border spinner-border-sm",role:"status"},Ve=Object(c["i"])("span",{class:"visually-hidden"},"Loading...",-1);function ze(e,t,a,s,n,i){return Object(c["u"])(),Object(c["e"])(c["a"],null,[Object(c["i"])("div",Oe,[me,Object(c["i"])("div",je,[Object(c["i"])("div",pe,[Object(c["i"])("div",fe,[ve,Object(c["O"])(Object(c["i"])("input",{type:"text",class:"form-control",id:"admin_remark","onUpdate:modelValue":t[1]||(t[1]=function(e){return s.remarkText=e})},null,512),[[c["J"],s.remarkText]])]),Object(c["i"])("button",{class:"btn btn-secondary ms-auto",onClick:t[2]||(t[2]=function(e){return s.PostAmdinRemark()}),disabled:s.remarkBtnDisabled},"送出訊息",8,["disabled"])]),ge,he,Object(c["i"])("div",ye,[s.remarkOverlay?(Object(c["u"])(),Object(c["e"])("div",ke,[Object(c["i"])("button",{class:"btn btn-primary",onClick:t[3]||(t[3]=function(e){s.getUserRemark(s.tempID)})},[xe,s.remarkLoading?(Object(c["u"])(),Object(c["e"])("div",we,[Le])):Object(c["f"])("",!0)])])):Object(c["f"])("",!0),(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(e.remarks,(function(e,t){return Object(c["u"])(),Object(c["e"])("p",{class:"mb-1",key:"admin_msg"+t}," [ "+Object(c["E"])(new Date(e.create_time).toLocaleString())+" ] "+Object(c["E"])(e.content),1)})),128))])])]),Object(c["i"])("div",Ie,[_e,Object(c["i"])("div",De,[Object(c["i"])("div",Ue,[s.adminLogOverlay?(Object(c["u"])(),Object(c["e"])("div",Me,[Object(c["i"])("button",{class:"btn btn-primary",onClick:t[4]||(t[4]=function(e){s.getUserAdminLog(s.tempID)})},[Ae,s.adminLogLoading?(Object(c["u"])(),Object(c["e"])("div",Re,[Ee])):Object(c["f"])("",!0)])])):Object(c["f"])("",!0),(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(e.adminLog,(function(e,t){return Object(c["u"])(),Object(c["e"])("p",{class:"mb-1",key:"user_msg"+t}," [ "+Object(c["E"])(new Date(e.create_time).toLocaleString())+" ] "+Object(c["E"])(e.content),1)})),128))])])]),Object(c["i"])("div",Ne,[Ce,Object(c["i"])("div",He,[Object(c["i"])("div",Te,[s.userLogOverlay?(Object(c["u"])(),Object(c["e"])("div",Be,[Object(c["i"])("button",{class:"btn btn-primary",onClick:t[5]||(t[5]=function(e){s.getUserLog(s.tempID)})},[Pe,s.userLogLoading?(Object(c["u"])(),Object(c["e"])("div",Je,[Ve])):Object(c["f"])("",!0)])])):Object(c["f"])("",!0),(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(e.log,(function(e,t){return Object(c["u"])(),Object(c["e"])("p",{class:"mb-1",key:"user_msg"+t}," [ "+Object(c["E"])(new Date(e.create_time).toLocaleString())+" ] "+Object(c["E"])(e.content),1)})),128))])])])],64)}var Se={name:"UserLog",setup:function(){var e=Object(Q["c"])(),t=Object(c["k"])(),a=t.proxy,s=Object(c["x"])(""),n=Object(c["x"])(""),i=Object(c["x"])(!1),l=Object(c["w"])({log:[],adminLog:[],remarks:[]}),o=Object(c["x"])(!0),r=Object(c["x"])(!1);function d(e){r.value=!0,a.axios.get("/v1/user/".concat(e,"/log")).then((function(e){l.log=e.data.user_logs,i.value=!1,o.value=!1,r.value=!1}))}var b=Object(c["x"])(!0),u=Object(c["x"])(!1);function O(e){u.value=!0,a.axios.get("/v1/user/".concat(e,"/admin_log")).then((function(e){l.adminLog=e.data.admin_logs,i.value=!1,b.value=!1,u.value=!1}))}var m=Object(c["x"])(!0),j=Object(c["x"])(!1);function p(e){j.value=!0,a.axios.get("/v1/user/".concat(e,"/remark")).then((function(e){l.remarks=e.data.remarks,i.value=!1,m.value=!1,j.value=!1}))}function f(){var t=e.params.id;i.value=!0,a.axios.post("/v1/user/".concat(t,"/remark"),{remark:n.value}).then((function(e){n.value="","成功"===e.data.message&&p(t)}))}return Object(c["s"])((function(){var t=e.params.id;s.value=t})),Object(K["a"])({PostAmdinRemark:f,remarkBtnDisabled:i,remarkText:n,tempID:s,remarkOverlay:m,remarkLoading:j,userLogOverlay:o,userLogLoading:r,adminLogOverlay:b,adminLogLoading:u,getUserRemark:p,getUserAdminLog:O,getUserLog:d},Object(c["G"])(l))}};Se.render=ze;var Ge=Se,$e=(a("caad"),a("2532"),{class:"card shadow-sm rounded-4 overflow-hidden mb-4 position-relative"}),Fe=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," upcoming "),Object(c["h"])(" 角色管理")])],-1),qe={class:"card-body"},Ke={class:"d-flex justify-content-end"},Qe={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},We=Object(c["i"])("div",{class:"card-header bg-white py-3"},[Object(c["i"])("p",{class:"mb-0"},[Object(c["i"])("span",{class:"material-icons align-bottom"}," voicemail "),Object(c["h"])(" 單一權限 ")])],-1),Xe={class:"card-body"},Ye=Object(c["i"])("input",{class:"form-control form-control-sm",type:"text",placeholder:"搜尋"},null,-1),Ze={class:"list-unstyled mt-4 overflow-y-auto",style:{"max-height":"350px"}},et={class:"form-check"},tt={class:"list-unstyled ms-4"},at={class:"d-flex justify-content-end"};function ct(e,t,a,s,n,i){var l=Object(c["B"])("loading");return Object(c["u"])(),Object(c["e"])(c["a"],null,[Object(c["i"])("div",$e,[Object(c["i"])(l,{active:s.isLoading,"is-full-page":s.fullPage},null,8,["active","is-full-page"]),Fe,Object(c["i"])("div",qe,[(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(e.roleList,(function(a){return Object(c["u"])(),Object(c["e"])("div",{class:"form-check form-switch",key:a.id},[Object(c["O"])(Object(c["i"])("input",{class:"form-check-input",type:"checkbox",id:"c_"+a.id,value:a.id,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.userHasRole=t})},null,8,["id","value"]),[[c["I"],e.userHasRole]]),Object(c["i"])("label",{class:"form-check-label",for:"c_"+a.id},Object(c["E"])(a.cht_name),9,["for"])])})),128)),Object(c["i"])("div",Ke,[Object(c["i"])("button",{class:"btn btn-sm btn-primary",onClick:t[2]||(t[2]=function(t){return s.update("roles",e.userHasRole)}),disabled:s.btnDisabled},"更新",8,["disabled"])])])]),Object(c["i"])("div",Qe,[We,Object(c["i"])("div",Xe,[Ye,Object(c["i"])("ul",Ze,[(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(e.rangeList,(function(a,n){return Object(c["u"])(),Object(c["e"])("li",{key:"range"+n},[Object(c["i"])("div",et,[Object(c["i"])("input",{class:"form-check-input",type:"checkbox",id:a.name,checked:a.sub_ranges.every((function(t){return e.userHasRanges.includes(t.id)})),onChange:t[3]||(t[3]=function(){return s.CheckAllRoles&&s.CheckAllRoles.apply(s,arguments)})},null,40,["id","checked"]),Object(c["i"])("label",{class:"form-check-label",for:a.name},Object(c["E"])(a.cht_name),9,["for"])]),Object(c["i"])("ul",tt,[Object(c["i"])("li",null,[(Object(c["u"])(!0),Object(c["e"])(c["a"],null,Object(c["z"])(a.sub_ranges,(function(a,s){return Object(c["u"])(),Object(c["e"])("div",{class:"form-check",key:"sub"+a.id+s},[Object(c["O"])(Object(c["i"])("input",{class:"form-check-input",type:"checkbox",id:"sub"+a.id,value:a.id,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.userHasRanges=t})},null,8,["id","value"]),[[c["I"],e.userHasRanges]]),Object(c["i"])("label",{class:"form-check-label",for:"sub"+a.id},Object(c["E"])(a.cht_name),9,["for"])])})),128))])])])})),128))]),Object(c["i"])("div",at,[Object(c["i"])("button",{class:"btn btn-sm btn-primary",onClick:t[5]||(t[5]=function(t){return s.update("ranges",e.userHasRanges)}),disabled:s.btnDisabled},"更新",8,["disabled"])])])])],64)}a("159b"),a("4de4"),a("99af");var st=a("8a14"),nt=(a("fe26"),a("c85d")),it={name:"RoleAndPermissions",components:{Loading:st["a"]},setup:function(){var e=Object(Q["c"])(),t=Object(c["k"])(),a=t.proxy,s=Object(nt["a"])(),n=s.postToasts,i=Object(c["x"])(!1),l=Object(c["x"])(!0),o=Object(c["x"])(""),r=Object(c["w"])({roleList:[],rangeList:[],userHasRole:[],userHasRanges:[]});function d(){a.axios("/v1/permission/roles").then((function(e){r.roleList=e.data.roles,a.axios("/v1/permission/ranges").then((function(e){r.rangeList=e.data.ranges}))}))}function b(e){i.value=!0,r.userHasRole=[],r.userHasRanges=[],a.axios("/v1/user/".concat(e,"/permissions")).then((function(e){e.data.roles.forEach((function(e){r.userHasRole.push(e.role_id)})),e.data.ranges.forEach((function(e){e.ranges.forEach((function(e){r.userHasRanges.push(e.id)}))})),i.value=!1})).catch((function(e){i.value=!1,n("danger","取得使用者角色和權限失敗",e)}))}function u(e){var t=r.rangeList.filter((function(t){return t.name===e.target.id}));e.target.checked?t[0].sub_ranges.forEach((function(e){r.userHasRanges.some((function(t){return t===e.id}))||(r.userHasRanges=r.userHasRanges.concat([e.id]))})):t[0].sub_ranges.forEach((function(e){r.userHasRanges=r.userHasRanges.filter((function(t){return t!==e.id}))}))}var O=Object(c["x"])(!1);function m(e,t){O.value=!0;var c="/v1/user/".concat(o.value,"/permission/").concat(e),s={};s[e]=t,a.axios.put(c,s).then((function(t){"成功"===t.data.message?n("success","編輯 ".concat(e," 成功"),"編輯 ".concat(e," 成功")):n("danger","編輯 ".concat(e," 失敗"),t.data.message),O.value=!1,b(o.value)})).catch((function(t){O.value=!1,n("danger","編輯 ".concat(e," 失敗"),t)}))}return Object(c["s"])((function(){var t=e.params.id;d(),b(t),o.value=t})),Object(K["a"])(Object(K["a"])({CheckAllRoles:u},Object(c["G"])(r)),{},{update:m,isLoading:i,fullPage:l,btnDisabled:O})}};it.render=ct;var lt=it,ot={name:"UserDetail",components:{Loading:st["a"],AlertModal:X["a"],DangerActionsModal:le,UserLog:Ge,RoleAndPermissions:lt,OrderList:ue},setup:function(){var e=Object(c["k"])(),t=e.proxy,a=Object(Q["c"])(),s=Object(Q["d"])(),n=Object(nt["a"])(),i=n.postToasts,l=Object(c["x"])(!1),o=Object(c["x"])(!1),r=Object(c["w"])({userInfo:{},tempData:{}});function d(e){t.axios.get("/v1/user/".concat(e,"/info")).then((function(e){r.userInfo=e.data.user_info,r.userInfo.name&&""!==r.userInfo.name&&(r.tempData.name=r.userInfo.name),r.tempData.nickname=r.userInfo.nickname,l.value=!1}))}var b=Object(c["x"])("");Object(c["s"])((function(){var e=a.params.id;d(e),l.value=!0,b.value=new W["b"](document.getElementById("alertModal"))}));var u=Object(c["x"])(""),O=Object(c["x"])(""),m=Object(c["x"])("");function j(e,t,a){b.value.show(),u.value=e,O.value=t,m.value=a}var p=Object(c["x"])("");Object(c["s"])((function(){p.value=new W["b"](document.getElementById("userDangerActions"))}));var f=Object(c["x"])(""),v=Object(c["x"])("");function g(e,t){p.value.show(),f.value=e,v.value=t}function h(){t.axios.post("/v1/user/".concat(m.value,"/reset_password")).then((function(e){"成功"===e.data.message?(b.value.hide(),i("success","已寄出重設密碼信件","".concat(O.value," 的重設密碼信件已經成功寄出。"))):(b.value.hide(),i("danger","重設密碼信件寄出失敗",e.data.message))})).catch((function(e){b.value.hide(),i("danger","重設密碼信件寄出失敗",e)}))}function y(e){"resetPassword"===e&&h()}function k(e){l.value=!0,r.userInfo.password&&""!==r.userInfo.password&&(r.tempData.password=r.userInfo.password),t.axios.put("/v1/user/".concat(e,"/info"),r.tempData).then((function(t){r.userInfo={},"成功"===t.data.message&&d(e),l.value=!1}))}function x(e){var a=r.userInfo.user_id,c={method:"",url:""};"delete"===e.type?(c.method="delete",c.url="/v1/user/".concat(a)):"deactivated"===e.type&&(c.method="put",c.url="/v1/user/".concat(a,"/suspend")),t.axios[c.method](c.url).then((function(t){"成功"===t.data.message?(p.value.hide(),i("success","危險操作成功，3 秒後跳回使用者列表","用戶已經被 ".concat(e.type," 了。"))):(p.value.hide(),i("danger","危險操作失敗，3 秒後跳回使用者列表",t.data.message)),setTimeout((function(){s.push("/admin/users")}),3e3)})).catch((function(e){p.value.hide(),i("danger","危險操作失敗，3 秒後跳回使用者列表",e)}))}return Object(K["a"])(Object(K["a"])({isLoading:l,fullPage:o},Object(c["G"])(r)),{},{getUserInfo:d,OpenAlertModal:j,alertModalType:u,alertModalUserName:O,dangerActionsType:f,dangerActionsName:v,OpenDangerModal:g,comfirmAlertModal:y,updateUerInfo:k,dangerUserMethod:x})}};a("6d05");ot.render=q;t["default"]=ot},"6d05":function(e,t,a){"use strict";a("0673")}}]);
//# sourceMappingURL=chunk-1f339db2.cffad2e8.js.map