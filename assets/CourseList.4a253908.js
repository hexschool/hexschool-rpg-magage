import{r,o as F,B as T,z as y,a as o,e as U,f as C,A as h,M as q,b as e,E as G,w as j,c as l,F as V,q as N,h as L,Q as I,x as M,D as O,p as w,g as A}from"./index.130d352d.js";import{a as B}from"./courses.6d178db5.js";import{a as P}from"./assistant.fec5cb3b.js";const Q={class:"mb-3"},H=e("label",{for:"addName",class:"form-label text-dark"},"\u8AB2\u7A0B\u540D\u7A31",-1),J={class:"mb-3"},K=e("label",{for:"addAssistants",class:"form-label text-dark"},"\u9810\u8A2D\u52A9\u6559",-1),W=e("option",{value:"",disabled:""}," \u8ACB\u9078\u64C7\u52A9\u6559 ",-1),X=["value"],Y=["disabled"],Z={__name:"CreateCourseModal",emits:["createCourseMethod"],setup(D,{expose:g,emit:f}){const{apiPostCreateCourse:b}=B,{apiGetAssistantList:v}=P,c=r(),p=r(""),u=r(""),n=async()=>{try{const s={name:p.value};u.value&&(s.default_assistant_user_id=u.value),await b(s),f("createCourseMethod",{target:"import",type:"\u6210\u529F"}),c.value.resetForm()}catch(s){f("createCourseMethod",{target:"import",type:"\u5931\u6557",error:`${s.response.status}:${s.response.statusText}`})}},a=r([]),k=async()=>{var s,d;try{const{assistants:m}=await v();a.value=m}catch(m){M("danger","\u7372\u53D6\u52A9\u6559\u5217\u8868\u5931\u6557",`${(s=m.response.data)==null?void 0:s.statusCode}:${(d=m.response.data)==null?void 0:d.message}`)}},t=r(null),_=r(null);return F(()=>{k(),_.value=new T(t.value.hModal)}),g({openModal:()=>{_.value.show()},hideModal:()=>{_.value.hide()}}),(s,d)=>{const m=y("Field"),E=y("ErrorMessage"),R=y("VForm");return o(),U(R,{ref_key:"refs",ref:c,onSubmit:n},{default:C(({errors:z,meta:S})=>[h(q,{id:"createCourseModal",ref_key:"createCourseModalRef",ref:t,"has-footer":!0,title:"\u65B0\u589E\u8AB2\u7A0B","class-list":""},{body:C(()=>[e("div",Q,[H,h(m,{id:"addName",modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=i=>p.value=i),name:"\u8AB2\u7A0B\u540D\u7A31",type:"text",class:G(["form-control",{"is-invalid":z.\u8AB2\u7A0B\u540D\u7A31}]),rules:"required"},null,8,["modelValue","class"]),h(E,{name:"\u8AB2\u7A0B\u540D\u7A31",class:"invalid-feedback"})]),e("div",J,[K,j(e("select",{id:"addAssistants","onUpdate:modelValue":d[1]||(d[1]=i=>u.value=i),name:"\u9810\u8A2D\u52A9\u6559",class:"form-control text-dark"},[W,(o(!0),l(V,null,N(a.value,i=>(o(),l("option",{key:i.user_id,value:i.user_id},L(i.nickname),9,X))),128))],512),[[I,u.value]])])]),footer:C(()=>[e("button",{type:"submit",disabled:!S.valid,class:"btn btn-primary"}," \u5EFA\u7ACB ",8,Y)]),_:2},1536)]),_:1},512)}}},ee={class:"about px-4 mt-4 position-relative"},te={class:"d-flex align-items-center justify-content-between"},se=e("h1",{class:"fs-4 mb-0"}," \u8AB2\u7A0B\u7BA1\u7406 ",-1),ae=e("hr",null,null,-1),oe={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},ne={class:"card-body p-0"},re={class:"table-responsive"},le={class:"table table-hover mb-0 text-nowrap",style:{"font-size":"14px"}},de=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{scope:"col",class:"ps-4 py-3 text-muted border-0"}," \u8AB2\u7A0B\u540D\u7A31 "),e("th",{scope:"col",class:"py-3 text-muted border-0"}," \u52A9\u6559\u6578 "),e("th",{scope:"col",class:"py-3 text-muted border-0"}," \u5C0D\u61C9\u7684\u8AB2\u7A0B "),e("th",{scope:"col",class:"py-3 text-muted pe-3 border-0"}," \u7DE8\u8F2F ")])],-1),ie={class:"text-nowrap"},ce={scope:"row",class:"ps-4"},ue={class:"fs-6 mb-0"},_e=["href"],me=["href"],pe={class:"pe-3"},he=e("span",{class:"material-icons align-middle fs-6"},"edit",-1),ye={__name:"CourseList",setup(D){const{apiGetCourseList:g}=B,f=O.useLoading(),b=r([]),v=async()=>{const n=f.show();try{const{courses:a}=await g();b.value=a}catch(a){M("danger","\u53D6\u5F97\u8AB2\u7A0B\u5217\u8868\u5931\u6557",`${a.response.data.statusCode}:${a.response.data.message}`)}finally{n.hide()}};F(v);const c=r(null),p=()=>{c.value.openModal()},u=n=>{n.type==="\u6210\u529F"?M("success","\u5EFA\u7ACB\u8AB2\u7A0B\u6210\u529F","\u5DF2\u6210\u529F\u5EFA\u7ACB\u8AB2\u7A0B"):n.type==="\u5931\u6557"&&M("danger","\u5EFA\u7ACB\u8AB2\u7A0B\u5931\u6557",n.error),c.value.hideModal(),v()};return(n,a)=>{const k=y("router-link");return o(),l("div",ee,[e("header",te,[se,e("button",{class:"btn btn-primary",onClick:a[0]||(a[0]=t=>p())}," \u65B0\u589E\u8AB2\u7A0B ")]),ae,e("div",oe,[e("div",ne,[e("div",re,[e("table",le,[de,e("tbody",ie,[(o(!0),l(V,null,N(b.value,t=>{var _,x,$,s;return o(),l("tr",{key:t.id,class:"align-middle"},[e("td",ce,[e("h5",ue,L(t.name),1)]),e("td",null,L(t.assistant_count),1),e("td",null,[(_=t.teachable_info)!=null&&_.id?(o(),l("a",{key:0,href:t.teachable_info.url,target:"_blank"}," Teachable \u9023\u7D50 ",8,_e)):w("",!0),((x=t.udemy_info)==null?void 0:x.id)&&(($=t.teachable_info)==null?void 0:$.id)?(o(),l(V,{key:1},[A(" | ")],64)):w("",!0),(s=t.udemy_info)!=null&&s.id?(o(),l("a",{key:2,href:t.udemy_info.url,target:"_blank"}," Udemy \u9023\u7D50 ",8,me)):w("",!0)]),e("td",pe,[h(k,{to:`/admin/courses/${t.id}`,class:"btn btn-sm btn-outline-gray"},{default:C(()=>[he,A("\u7DE8\u8F2F ")]),_:2},1032,["to"])])])}),128))])])])])]),h(Z,{ref_key:"createCourseModalComponentRef",ref:c,onCreateCourseMethod:u},null,512)])}}};export{ye as default};
